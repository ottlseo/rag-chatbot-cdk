"use strict";
var _a;
Object.defineProperty(exports, "__esModule", { value: true });
exports.WebCrawler = exports.CrawlerTargetType = void 0;
const JSII_RTTI_SYMBOL_1 = Symbol.for("jsii.rtti");
/**
 *  Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.
 *
 *  Licensed under the Apache License, Version 2.0 (the "License"). You may not use this file except in compliance
 *  with the License. A copy of the License is located at
 *
 *      http://www.apache.org/licenses/LICENSE-2.0
 *
 *  or in the 'license' file accompanying this file. This file is distributed on an 'AS IS' BASIS, WITHOUT WARRANTIES
 *  OR CONDITIONS OF ANY KIND, express or implied. See the License for the specific language governing permissions
 *  and limitations under the License.
 */
const crypto = require("crypto");
const path = require("path");
const url = require("url");
const cdk = require("aws-cdk-lib");
const batch = require("aws-cdk-lib/aws-batch");
const dynamodb = require("aws-cdk-lib/aws-dynamodb");
const ec2 = require("aws-cdk-lib/aws-ec2");
const aws_ecr_assets = require("aws-cdk-lib/aws-ecr-assets");
const ecs = require("aws-cdk-lib/aws-ecs");
const events = require("aws-cdk-lib/aws-events");
const targets = require("aws-cdk-lib/aws-events-targets");
const iam = require("aws-cdk-lib/aws-iam");
const aws_iam_1 = require("aws-cdk-lib/aws-iam");
const kms = require("aws-cdk-lib/aws-kms");
const lambda = require("aws-cdk-lib/aws-lambda");
const logs = require("aws-cdk-lib/aws-logs");
const s3 = require("aws-cdk-lib/aws-s3");
const sns = require("aws-cdk-lib/aws-sns");
const cr = require("aws-cdk-lib/custom-resources");
const cdk_nag_1 = require("cdk-nag");
const base_class_1 = require("../../../common/base-class");
const base_class_2 = require("../../../common/base-class/base-class");
const s3_bucket_helper = require("../../../common/helpers/s3-bucket-helper");
const vpc_helper = require("../../../common/helpers/vpc-helper");
const types_1 = require("../../../patterns/gen-ai/aws-rag-appsync-stepfn-kendra/types");
var CrawlerTargetType;
(function (CrawlerTargetType) {
    CrawlerTargetType["WEBSITE"] = "website";
    CrawlerTargetType["RSS_FEED"] = "rss_feed";
})(CrawlerTargetType || (exports.CrawlerTargetType = CrawlerTargetType = {}));
class WebCrawler extends base_class_2.BaseClass {
    /**
     * Constructs a new instance of the WebCrawler class.
     * @param {Construct} scope - represents the scope for all the resources.
     * @param {string} id - this is a a scope-unique id.
     * @param {WebCrawlerProps} props - user provided props for the construct.
     * @since 0.0.0
     * @public
     */
    constructor(scope, id, props) {
        super(scope, id);
        vpc_helper.CheckVpcProps(props);
        s3_bucket_helper.CheckS3Props({
            existingBucketObj: props.existingOutputBucketObj,
            bucketProps: props.bucketOutputProps,
        });
        if (props?.existingVpc) {
            this.vpc = props.existingVpc;
        }
        else if (props.vpcProps) {
            this.vpc = new ec2.Vpc(this, 'webCrawlerVpc', props.vpcProps);
        }
        else {
            this.vpc = new ec2.Vpc(this, 'webCrawlerVpc', {
                createInternetGateway: true,
                natGateways: 1,
            });
        }
        // add VPC endpoints for the compute environment
        vpc_helper.AddAwsServiceEndpoint(this, this.vpc, types_1.ServiceEndpointTypeEnum.ECR_API);
        vpc_helper.AddAwsServiceEndpoint(this, this.vpc, types_1.ServiceEndpointTypeEnum.ECR_DKR);
        vpc_helper.AddAwsServiceEndpoint(this, this.vpc, types_1.ServiceEndpointTypeEnum.S3);
        // vpc flowloggroup
        const logGroup = new logs.LogGroup(this, 'webCrawlerConstructLogGroup');
        const role = new iam.Role(this, 'webCrawlerConstructRole', {
            assumedBy: new iam.ServicePrincipal('vpc-flow-logs.amazonaws.com'),
        });
        // vpc flowlogs
        new ec2.FlowLog(this, 'FlowLog', {
            resourceType: ec2.FlowLogResourceType.fromVpc(this.vpc),
            destination: ec2.FlowLogDestination.toCloudWatchLogs(logGroup, role),
        });
        const baseProps = {
            stage: props.stage,
            constructName: base_class_1.ConstructName.AWSWEBCRAWLER,
            constructId: id,
            observability: props.observability,
        };
        this.updateEnvSuffix(baseProps);
        this.addObservabilityToConstruct(baseProps);
        const targetsTable = new dynamodb.Table(this, 'targetsTable', {
            partitionKey: { name: 'target_url', type: dynamodb.AttributeType.STRING },
            billingMode: dynamodb.BillingMode.PAY_PER_REQUEST,
            removalPolicy: cdk.RemovalPolicy.DESTROY,
            pointInTimeRecovery: true,
            encryption: dynamodb.TableEncryption.AWS_MANAGED,
        });
        const jobsTable = new dynamodb.Table(this, 'jobsTable', {
            partitionKey: { name: 'target_url', type: dynamodb.AttributeType.STRING },
            sortKey: { name: 'job_id', type: dynamodb.AttributeType.STRING },
            billingMode: dynamodb.BillingMode.PAY_PER_REQUEST,
            removalPolicy: cdk.RemovalPolicy.DESTROY,
            pointInTimeRecovery: true,
            encryption: dynamodb.TableEncryption.AWS_MANAGED,
        });
        // bucket for storing server access logging
        const serverAccessLogBucket = new s3.Bucket(this, 'serverAccessLogBucket' + this.stage, {
            blockPublicAccess: s3.BlockPublicAccess.BLOCK_ALL,
            encryption: s3.BucketEncryption.S3_MANAGED,
            enforceSSL: true,
            versioned: true,
            lifecycleRules: [
                {
                    expiration: cdk.Duration.days(90),
                },
            ],
        });
        // Bucket containing the output data uploaded by the crawler
        let dataBucket;
        if (!props.existingOutputBucketObj) {
            let tmpBucket;
            if (!props.bucketOutputProps) {
                tmpBucket = new s3.Bucket(this, 'webCrawlerDataBucket' + this.stage, {
                    accessControl: s3.BucketAccessControl.PRIVATE,
                    blockPublicAccess: s3.BlockPublicAccess.BLOCK_ALL,
                    encryption: s3.BucketEncryption.S3_MANAGED,
                    bucketName: 'outputbucket' + this.stage.toLowerCase() + '-' + cdk.Aws.REGION + '-' + cdk.Aws.ACCOUNT_ID,
                    serverAccessLogsBucket: serverAccessLogBucket,
                    enforceSSL: true,
                    versioned: true,
                    lifecycleRules: [
                        {
                            expiration: cdk.Duration.days(90),
                        },
                    ],
                });
            }
            else {
                tmpBucket = new s3.Bucket(this, 'webCrawlerDataBucket' + this.stage, props.bucketOutputProps);
            }
            dataBucket = tmpBucket;
            this.dataBucket = tmpBucket;
        }
        else {
            dataBucket = props.existingOutputBucketObj;
        }
        const snsTopic = new sns.Topic(this, 'webCrawlerTopic', {
            masterKey: kms.Alias.fromAliasName(scope, 'aws-managed-key', 'alias/aws/sns'),
        });
        // Apply topic policy to enforce only the topic owner can publish and subscribe to this topic
        snsTopic.addToResourcePolicy(new aws_iam_1.PolicyStatement({
            sid: 'TopicOwnerOnlyAccess',
            resources: [`${snsTopic.topicArn}`],
            actions: [
                'SNS:Publish',
                'SNS:RemovePermission',
                'SNS:SetTopicAttributes',
                'SNS:DeleteTopic',
                'SNS:ListSubscriptionsByTopic',
                'SNS:GetTopicAttributes',
                'SNS:Receive',
                'SNS:AddPermission',
                'SNS:Subscribe',
            ],
            principals: [new aws_iam_1.AccountPrincipal(cdk.Stack.of(snsTopic).account)],
            effect: aws_iam_1.Effect.ALLOW,
            conditions: {
                StringEquals: {
                    'AWS:SourceOwner': cdk.Stack.of(snsTopic).account,
                },
            },
        }));
        // Apply Topic policy to enforce encryption of data in transit
        snsTopic.addToResourcePolicy(new aws_iam_1.PolicyStatement({
            sid: 'HttpsOnly',
            resources: [`${snsTopic.topicArn}`],
            actions: [
                'SNS:Publish',
                'SNS:RemovePermission',
                'SNS:SetTopicAttributes',
                'SNS:DeleteTopic',
                'SNS:ListSubscriptionsByTopic',
                'SNS:GetTopicAttributes',
                'SNS:Receive',
                'SNS:AddPermission',
                'SNS:Subscribe',
            ],
            principals: [new aws_iam_1.AnyPrincipal()],
            effect: aws_iam_1.Effect.DENY,
            conditions: {
                Bool: {
                    'aws:SecureTransport': 'false',
                },
            },
        }));
        const computeEnvironment = new batch.FargateComputeEnvironment(this, 'webCrawlerEnvironment', {
            vpc: this.vpc,
            maxvCpus: 8,
            replaceComputeEnvironment: true,
            updateTimeout: cdk.Duration.minutes(30),
            updateToLatestImageVersion: true,
            vpcSubnets: { subnetType: ec2.SubnetType.PRIVATE_WITH_EGRESS },
        });
        const jobQueue = new batch.JobQueue(this, 'webCrawlerJobQueue', {
            computeEnvironments: [
                {
                    computeEnvironment,
                    order: 1,
                },
            ],
            priority: 1,
        });
        const webCrawlerJobRole = new iam.Role(this, 'webCrawlerJobRole', {
            assumedBy: new iam.ServicePrincipal('ecs-tasks.amazonaws.com'),
            inlinePolicies: {
                FargateContainerServiceRolePolicy: new iam.PolicyDocument({
                    statements: [
                        new iam.PolicyStatement({
                            actions: ['ecr:BatchCheckLayerAvailability', 'ecr:GetDownloadUrlForLayer', 'ecr:BatchGetImage'],
                            effect: iam.Effect.ALLOW,
                            resources: ['arn:' + cdk.Aws.PARTITION + ':ecr:' + cdk.Aws.REGION + ':' + cdk.Aws.ACCOUNT_ID + ':repository/*'],
                        }),
                        new iam.PolicyStatement({
                            actions: ['ecr:GetAuthorizationToken'],
                            effect: iam.Effect.ALLOW,
                            resources: ['*'],
                        }),
                        new iam.PolicyStatement({
                            actions: ['logs:CreateLogStream', 'logs:PutLogEvents'],
                            effect: iam.Effect.ALLOW,
                            resources: ['arn:' + cdk.Aws.PARTITION + ':logs:' + cdk.Aws.REGION + ':' + cdk.Aws.ACCOUNT_ID + ':log-group:*'],
                        }),
                    ],
                }),
            },
        });
        const webCrawlerContainer = new batch.EcsFargateContainerDefinition(this, 'webCrawlerContainer', {
            cpu: 2,
            memory: cdk.Size.mebibytes(6144),
            image: ecs.ContainerImage.fromAsset(path.join(__dirname, '../../../../resources/gen-ai/aws-web-crawler-container'), {
                platform: aws_ecr_assets.Platform.LINUX_AMD64,
            }),
            jobRole: webCrawlerJobRole,
            environment: {
                AWS_DEFAULT_REGION: cdk.Stack.of(this).region,
                TARGETS_TABLE_NAME: targetsTable.tableName,
                JOBS_TABLE_NAME: jobsTable.tableName,
                DATA_BUCKET_NAME: dataBucket.bucketName,
                SNS_TOPIC_ARN: snsTopic.topicArn,
            },
        });
        targetsTable.grantReadWriteData(webCrawlerJobRole);
        jobsTable.grantReadWriteData(webCrawlerJobRole);
        dataBucket.grantReadWrite(webCrawlerJobRole);
        snsTopic.grantPublish(webCrawlerJobRole);
        cdk_nag_1.NagSuppressions.addResourceSuppressions(webCrawlerContainer.executionRole, [
            {
                id: 'AwsSolutions-IAM5',
                reason: 'CDK CustomResource Provider has a wildcard to invoke any version of the specific Custom Resource function.',
            },
        ], true);
        cdk_nag_1.NagSuppressions.addResourceSuppressions(webCrawlerContainer.executionRole, [
            {
                id: 'AwsSolutions-IAM4',
                reason: 'The AWSLambdaBasicExecutionRole managed policy is required for ' + 'the Lambda function to write logs to CloudWatch.',
            },
        ]);
        cdk_nag_1.NagSuppressions.addResourceSuppressions(webCrawlerJobRole, [
            {
                id: 'AwsSolutions-IAM5',
                reason: 'CDK CustomResource Provider has a wildcard to invoke any version of the specific Custom Resource function.',
            },
        ], true);
        cdk_nag_1.NagSuppressions.addResourceSuppressions(webCrawlerJobRole, [
            {
                id: 'AwsSolutions-IAM4',
                reason: 'The AWSLambdaBasicExecutionRole managed policy is required for ' + 'the Lambda function to write logs to CloudWatch.',
            },
        ]);
        const webCrawlerJobDefinition = new batch.EcsJobDefinition(this, 'webCrawlerJob', {
            container: webCrawlerContainer,
            retryAttempts: 1,
            timeout: cdk.Duration.hours(48),
            retryStrategies: [
                batch.RetryStrategy.of(batch.Action.EXIT, batch.Reason.CANNOT_PULL_CONTAINER),
                batch.RetryStrategy.of(batch.Action.EXIT, batch.Reason.custom({
                    onExitCode: '137',
                })),
            ],
        });
        for (const target of props.targets ?? []) {
            let targetUrl = target.url.trim();
            if (!/^https?:\/\//.test(targetUrl.toLowerCase())) {
                targetUrl = `https://${targetUrl}`;
            }
            let target_s3_key = encodeURIComponent(url.parse(targetUrl).hostname?.replace(/\./g, '-').substring(0, 30) ?? targetUrl);
            const hash = crypto
                .createHash('sha256')
                .update(targetUrl)
                .digest('base64')
                .replace(/\+/g, '-')
                .replace(/\//g, '_')
                .substring(0, 12);
            target_s3_key = `${target_s3_key}-${hash}`;
            new cr.AwsCustomResource(this, `target-${target_s3_key}`, {
                onCreate: {
                    service: 'DynamoDB',
                    action: 'putItem',
                    parameters: {
                        TableName: targetsTable.tableArn,
                        Item: {
                            target_url: { S: targetUrl },
                            target_s3_key: { S: target_s3_key },
                            target_type: { S: target.targetType },
                            sitemaps: { L: [] },
                            max_requests: { N: `${target.maxRequests ?? 0}` },
                            max_files: { N: `${target.maxFiles ?? 0}` },
                            download_files: { BOOL: target.downloadFiles ?? true },
                            file_types: { L: target.fileTypes ?? [] },
                            crawl_interval_hours: { N: `${target.crawlIntervalHours ?? 0}` },
                            last_finished_job_id: { S: '' },
                            last_finished_job_date: { S: '' },
                            created_at: { N: `${Date.now()}` },
                            updated_at: { N: `${Date.now()}` },
                        },
                    },
                    physicalResourceId: cr.PhysicalResourceId.of(targetUrl),
                },
                onUpdate: {
                    service: 'DynamoDB',
                    action: 'updateItem',
                    parameters: {
                        TableName: targetsTable.tableArn,
                        Key: {
                            target_url: { S: targetUrl },
                        },
                        UpdateExpression: 'SET target_type = :target_type, max_requests = :max_requests, max_files = :max_files, download_files = :download_files, file_types = :file_types, crawl_interval_hours = :crawl_interval_hours',
                        ExpressionAttributeValues: {
                            ':target_type': { S: target.targetType },
                            ':max_requests': { N: `${target.maxRequests ?? 0}` },
                            ':max_files': { N: `${target.maxFiles ?? 0}` },
                            ':download_files': { BOOL: target.downloadFiles ?? true },
                            ':file_types': { L: target.fileTypes ?? [] },
                            ':crawl_interval_hours': { N: `${target.crawlIntervalHours ?? 0}` },
                        },
                        ReturnValues: 'UPDATED_NEW',
                    },
                },
                onDelete: {
                    service: 'DynamoDB',
                    action: 'deleteItem',
                    parameters: {
                        TableName: targetsTable.tableArn,
                        Key: {
                            target_url: { S: targetUrl },
                        },
                    },
                },
                policy: cr.AwsCustomResourcePolicy.fromStatements([
                    new iam.PolicyStatement({
                        actions: ['dynamodb:PutItem', 'dynamodb:GetItem', 'dynamodb:DeleteItem', 'dynamodb:UpdateItem'],
                        resources: [targetsTable.tableArn],
                    }),
                ]),
            });
            cdk_nag_1.NagSuppressions.addResourceSuppressionsByPath(cdk.Stack.of(this), `${cdk.Stack.of(this).stackName}/AWS${cr.AwsCustomResource.PROVIDER_FUNCTION_UUID.replace(/-/g, '')}/ServiceRole/Resource`, [
                {
                    id: 'AwsSolutions-IAM4',
                    reason: 'CDK CustomResource Lambda uses the AWSLambdaBasicExecutionRole AWS Managed Policy.',
                },
            ]);
            cdk_nag_1.NagSuppressions.addResourceSuppressionsByPath(cdk.Stack.of(this), `${cdk.Stack.of(this).stackName}/AWS${cr.AwsCustomResource.PROVIDER_FUNCTION_UUID.replace(/-/g, '')}/Resource`, [
                {
                    id: 'AwsSolutions-L1',
                    reason: 'Lambda runtime version is managed upstream by CDK.',
                },
            ]);
        }
        const schedulerFunction = new lambda.Function(this, 'webCrawlerSchedulerFunction', {
            runtime: lambda.Runtime.PYTHON_3_12,
            handler: 'lambda.handler',
            functionName: 'lambda_crawler_scheduler' + this.stage,
            tracing: this.lambdaTracing,
            timeout: cdk.Duration.minutes(15),
            memorySize: 256,
            code: lambda.Code.fromAsset(path.join(__dirname, '../../../../lambda/aws-web-crawler-scheduler')),
            logGroup: new logs.LogGroup(this, 'webCrawlerSchedulerLogGroup', { retention: logs.RetentionDays.ONE_WEEK }),
            environment: {
                TARGETS_TABLE_NAME: targetsTable.tableName,
                JOBS_TABLE_NAME: jobsTable.tableName,
                JOB_QUEUE_ARN: jobQueue.jobQueueArn,
                JOB_DEFINITION_ARN: webCrawlerJobDefinition.jobDefinitionArn,
            },
        });
        cdk_nag_1.NagSuppressions.addResourceSuppressions(schedulerFunction.role, [
            {
                id: 'AwsSolutions-IAM4',
                reason: 'Lambda uses the AWSLambdaBasicExecutionRole AWS Managed Policy.',
            },
        ]);
        cdk_nag_1.NagSuppressions.addResourceSuppressions(schedulerFunction.role, [
            {
                id: 'AwsSolutions-IAM5',
                reason: 'AWSLambdaBasicExecutionRole is used.',
            },
        ], true);
        targetsTable.grantReadWriteData(schedulerFunction);
        jobsTable.grantReadWriteData(schedulerFunction);
        schedulerFunction.addToRolePolicy(new iam.PolicyStatement({
            actions: ['batch:SubmitJob'],
            resources: [webCrawlerJobDefinition.jobDefinitionArn, jobQueue.jobQueueArn],
        }));
        const rule = new events.Rule(this, 'webCrawlerSchedulerRule', {
            schedule: events.Schedule.expression('cron(0/15 * * * ? *)'),
        });
        rule.addTarget(new targets.LambdaFunction(schedulerFunction));
        if (props.enableLambdaCrawler) {
            const lambdaCrawler = new lambda.Function(this, 'lambdaCrawler', {
                architecture: lambda.Architecture.X86_64,
                functionName: 'lambda_crawler_function' + this.stage,
                tracing: this.lambdaTracing,
                timeout: cdk.Duration.minutes(15),
                memorySize: 2048,
                handler: 'index.handler',
                runtime: lambda.Runtime.NODEJS_20_X,
                code: lambda.Code.fromDockerBuild(path.join(__dirname, '../../../../lambda/aws-web-crawler-lambda')),
            });
            this.lambdaCrawler = lambdaCrawler;
            cdk_nag_1.NagSuppressions.addResourceSuppressions(lambdaCrawler.role, [
                {
                    id: 'AwsSolutions-IAM5',
                    reason: 'AWSLambdaBasicExecutionRole is used.',
                },
            ], true);
            cdk_nag_1.NagSuppressions.addResourceSuppressions(lambdaCrawler.role, [
                {
                    id: 'AwsSolutions-IAM4',
                    reason: 'Lambda uses the AWSLambdaBasicExecutionRole AWS Managed Policy.',
                },
            ]);
        }
        this.dataBucket = dataBucket;
        this.snsTopic = snsTopic;
        this.targetsTable = targetsTable;
        this.jobsTable = jobsTable;
        this.jobQueue = jobQueue;
        this.webCrawlerJobDefinition = webCrawlerJobDefinition;
        this.lambdaCrawlerApiSchemaPath = path.join(__dirname, '../../../../lambda/aws-web-crawler-lambda/action-group.yaml');
    }
}
exports.WebCrawler = WebCrawler;
_a = JSII_RTTI_SYMBOL_1;
WebCrawler[_a] = { fqn: "@cdklabs/generative-ai-cdk-constructs.WebCrawler", version: "0.1.216" };
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiaW5kZXguanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi8uLi8uLi9zcmMvcGF0dGVybnMvZ2VuLWFpL2F3cy13ZWItY3Jhd2xlci9pbmRleC50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7OztBQUFBOzs7Ozs7Ozs7OztHQVdHO0FBQ0gsaUNBQWlDO0FBQ2pDLDZCQUE2QjtBQUM3QiwyQkFBMkI7QUFDM0IsbUNBQW1DO0FBQ25DLCtDQUErQztBQUMvQyxxREFBcUQ7QUFDckQsMkNBQTJDO0FBQzNDLDZEQUE2RDtBQUM3RCwyQ0FBMkM7QUFDM0MsaURBQWlEO0FBQ2pELDBEQUEwRDtBQUMxRCwyQ0FBMkM7QUFDM0MsaURBQThGO0FBQzlGLDJDQUEyQztBQUMzQyxpREFBaUQ7QUFDakQsNkNBQTZDO0FBQzdDLHlDQUF5QztBQUN6QywyQ0FBMkM7QUFDM0MsbURBQW1EO0FBQ25ELHFDQUEwQztBQUUxQywyREFBMkQ7QUFDM0Qsc0VBQWtGO0FBQ2xGLDZFQUE2RTtBQUM3RSxpRUFBaUU7QUFDakUsd0ZBQXVHO0FBbUd2RyxJQUFZLGlCQUdYO0FBSEQsV0FBWSxpQkFBaUI7SUFDM0Isd0NBQW1CLENBQUE7SUFDbkIsMENBQXFCLENBQUE7QUFDdkIsQ0FBQyxFQUhXLGlCQUFpQixpQ0FBakIsaUJBQWlCLFFBRzVCO0FBRUQsTUFBYSxVQUFXLFNBQVEsc0JBQVM7SUFzQ3ZDOzs7Ozs7O09BT0c7SUFDSCxZQUFZLEtBQWdCLEVBQUUsRUFBVSxFQUFFLEtBQXNCO1FBQzlELEtBQUssQ0FBQyxLQUFLLEVBQUUsRUFBRSxDQUFDLENBQUM7UUFFakIsVUFBVSxDQUFDLGFBQWEsQ0FBQyxLQUFLLENBQUMsQ0FBQztRQUNoQyxnQkFBZ0IsQ0FBQyxZQUFZLENBQUM7WUFDNUIsaUJBQWlCLEVBQUUsS0FBSyxDQUFDLHVCQUF1QjtZQUNoRCxXQUFXLEVBQUUsS0FBSyxDQUFDLGlCQUFpQjtTQUNyQyxDQUFDLENBQUM7UUFFSCxJQUFJLEtBQUssRUFBRSxX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Q0FBQyxPQUFPLENBQUMsV0FBVztnQkFDbkMsSUFBSSxFQUFFLE1BQU0sQ0FBQyxJQUFJLENBQUMsZUFBZSxDQUFDLElBQUksQ0FBQyxJQUFJLENBQUMsU0FBUyxFQUFFLDJDQUEyQyxDQUFDLENBQUM7YUFDckcsQ0FBQyxDQUFDO1lBRUgsSUFBSSxDQUFDLGFBQWEsR0FBRyxhQUFhLENBQUM7WUFFbkMseUJBQWUsQ0FBQyx1QkFBdUIsQ0FDckMsYUFBYSxDQUFDLElBQUssRUFDbkI7Z0JBQ0U7b0JBQ0UsRUFBRSxFQUFFLG1CQUFtQjtvQkFDdkIsTUFBTSxFQUFFLHNDQUFzQztpQkFDL0M7YUFDRixFQUNELElBQUksQ0FDTCxDQUFDO1lBRUYseUJBQWUsQ0FBQyx1QkFBdUIsQ0FBQyxhQUFhLENBQUMsSUFBSyxFQUFFO2dCQUMzRDtvQkFDRSxFQUFFLEVBQUUsbUJBQW1CO29CQUN2QixNQUFNLEVBQUUsaUVBQWlFO2lCQUMxRTthQUNGLENBQUMsQ0FBQztRQUNMLENBQUM7UUFFRCxJQUFJLENBQUMsVUFBVSxHQUFHLFVBQVUsQ0FBQztRQUM3QixJQUFJLENBQUMsUUFBUSxHQUFHLFFBQVEsQ0FBQztRQUN6QixJQUFJLENBQUMsWUFBWSxHQUFHLFlBQVksQ0FBQztRQUNqQyxJQUFJLENBQUMsU0FBUyxHQUFHLFNBQVMsQ0FBQztRQUMzQixJQUFJLENBQUMsUUFBUSxHQUFHLFFBQVEsQ0FBQztRQUN6QixJQUFJLENBQUMsdUJBQXVCLEdBQUcsdUJBQXVCLENBQUM7UUFDdkQsSUFBSSxDQUFDLDBCQUEwQixHQUFHLElBQUksQ0FBQyxJQUFJLENBQUMsU0FBUyxFQUFFLDZEQUE2RCxDQUFDLENBQUM7SUFDeEgsQ0FBQzs7QUF6Z0JILGdDQTBnQkMiLCJzb3VyY2VzQ29udGVudCI6WyIvKipcbiAqICBDb3B5cmlnaHQgQW1hem9uLmNvbSwgSW5jLiBvciBpdHMgYWZmaWxpYXRlcy4gQWxsIFJpZ2h0cyBSZXNlcnZlZC5cbiAqXG4gKiAgTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKS4gWW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZVxuICogIHdpdGggdGhlIExpY2Vuc2UuIEEgY29weSBvZiB0aGUgTGljZW5zZSBpcyBsb2NhdGVkIGF0XG4gKlxuICogICAgICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiAgb3IgaW4gdGhlICdsaWNlbnNlJyBmaWxlIGFjY29tcGFueWluZyB0aGlzIGZpbGUuIFRoaXMgZmlsZSBpcyBkaXN0cmlidXRlZCBvbiBhbiAnQVMgSVMnIEJBU0lTLCBXSVRIT1VUIFdBUlJBTlRJRVNcbiAqICBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBleHByZXNzIG9yIGltcGxpZWQuIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9uc1xuICogIGFuZCBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuaW1wb3J0ICogYXMgY3J5cHRvIGZyb20gJ2NyeXB0byc7XG5pbXBvcnQgKiBhcyBwYXRoIGZyb20gJ3BhdGgnO1xuaW1wb3J0ICogYXMgdXJsIGZyb20gJ3VybCc7XG5pbXBvcnQgKiBhcyBjZGsgZnJvbSAnYXdzLWNkay1saWInO1xuaW1wb3J0ICogYXMgYmF0Y2ggZnJvbSAnYXdzLWNkay1saWIvYXdzLWJhdGNoJztcbmltcG9ydCAqIGFzIGR5bmFtb2RiIGZyb20gJ2F3cy1jZGstbGliL2F3cy1keW5hbW9kYic7XG5pbXBvcnQgKiBhcyBlYzIgZnJvbSAnYXdzLWNkay1saWIvYXdzLWVjMic7XG5pbXBvcnQgKiBhcyBhd3NfZWNyX2Fzc2V0cyBmcm9tICdhd3MtY2RrLWxpYi9hd3MtZWNyLWFzc2V0cyc7XG5pbXBvcnQgKiBhcyBlY3MgZnJvbSAnYXdzLWNkay1saWIvYXdzLWVjcyc7XG5pbXBvcnQgKiBhcyBldmVudHMgZnJvbSAnYXdzLWNkay1saWIvYXdzLWV2ZW50cyc7XG5pbXBvcnQgKiBhcyB0YXJnZXRzIGZyb20gJ2F3cy1jZGstbGliL2F3cy1ldmVudHMtdGFyZ2V0cyc7XG5pbXBvcnQgKiBhcyBpYW0gZnJvbSAnYXdzLWNkay1saWIvYXdzLWlhbSc7XG5pbXBvcnQgeyBQb2xpY3lTdGF0ZW1lbnQsIEFueVByaW5jaXBhbCwgRWZmZWN0LCBBY2NvdW50UHJpbmNpcGFsIH0gZnJvbSAnYXdzLWNkay1saWIvYXdzLWlhbSc7XG5pbXBvcnQgKiBhcyBrbXMgZnJvbSAnYXdzLWNkay1saWIvYXdzLWttcyc7XG5pbXBvcnQgKiBhcyBsYW1iZGEgZnJvbSAnYXdzLWNkay1saWIvYXdzLWxhbWJkYSc7XG5pbXBvcnQgKiBhcyBsb2dzIGZyb20gJ2F3cy1jZGstbGliL2F3cy1sb2dzJztcbmltcG9ydCAqIGFzIHMzIGZyb20gJ2F3cy1jZGstbGliL2F3cy1zMyc7XG5pbXBvcnQgKiBhcyBzbnMgZnJvbSAnYXdzLWNkay1saWIvYXdzLXNucyc7XG5pbXBvcnQgKiBhcyBjciBmcm9tICdhd3MtY2RrLWxpYi9jdXN0b20tcmVzb3VyY2VzJztcbmltcG9ydCB7IE5hZ1N1cHByZXNzaW9ucyB9IGZyb20gJ2Nkay1uYWcnO1xuaW1wb3J0IHsgQ29uc3RydWN0IH0gZnJvbSAnY29uc3RydWN0cyc7XG5pbXBvcnQgeyBDb25zdHJ1Y3ROYW1lIH0gZnJvbSAnLi4vLi4vLi4vY29tbW9uL2Jhc2UtY2xhc3MnO1xuaW1wb3J0IHsgQmFzZUNsYXNzLCBCYXNlQ2xhc3NQcm9wcyB9IGZyb20gJy4uLy4uLy4uL2NvbW1vbi9iYXNlLWNsYXNzL2Jhc2UtY2xhc3MnO1xuaW1wb3J0ICogYXMgczNfYnVja2V0X2hlbHBlciBmcm9tICcuLi8uLi8uLi9jb21tb24vaGVscGVycy9zMy1idWNrZXQtaGVscGVyJztcbmltcG9ydCAqIGFzIHZwY19oZWxwZXIgZnJvbSAnLi4vLi4vLi4vY29tbW9uL2hlbHBlcnMvdnBjLWhlbHBlcic7XG5pbXBvcnQgeyBTZXJ2aWNlRW5kcG9pbnRUeXBlRW51bSB9IGZyb20gJy4uLy4uLy4uL3BhdHRlcm5zL2dlbi1haS9hd3MtcmFnLWFwcHN5bmMtc3RlcGZuLWtlbmRyYS90eXBlcyc7XG5cbmV4cG9ydCBpbnRlcmZhY2UgQ3Jhd2xlclRhcmdldCB7XG4gIC8qKlxuICAgKiBUYXJnZXQgVVJMIHRvIGJlIGNyYXdsZWQuXG4gICAqL1xuICByZWFkb25seSB1cmw6IHN0cmluZztcbiAgLyoqXG4gICAqIFR5cGUgb2YgVVJMIHRvIGJlIGNyYXdsZWQuXG4gICAqL1xuICByZWFkb25seSB0YXJnZXRUeXBlOiBDcmF3bGVyVGFyZ2V0VHlwZTtcbiAgLyoqXG4gICAqIE1heGltdW0gbnVtYmVyIG9mIHJlcXVlc3RzIHRvIGJlIG1hZGUgYnkgY3Jhd2xlci5cbiAgICpcbiAgICogQGRlZmF1bHQgLSBjcmF3bGVyIGxpbWl0XG4gICAqL1xuICByZWFkb25seSBtYXhSZXF1ZXN0cz86IG51bWJlcjtcbiAgLyoqXG4gICAqIERvd25sb2FkIGZpbGVzIGZyb20gdGhlIHdlYiBzaXRlLlxuICAgKlxuICAgKiBAZGVmYXVsdCAtIHRydWVcbiAgICovXG4gIHJlYWRvbmx5IGRvd25sb2FkRmlsZXM/OiBib29sZWFuO1xuICAvKipcbiAgICogTWF4aW11bSBudW1iZXIgb2YgZmlsZXMgdG8gYmUgZG93bmxvYWRlZC5cbiAgICpcbiAgICogQGRlZmF1bHQgLSBjcmF3bGVyIGxpbWl0XG4gICAqL1xuICByZWFkb25seSBtYXhGaWxlcz86IG51bWJlcjtcbiAgLyoqXG4gICAqIEZpbGUgdHlwZXMgKGV4dGVuc2lvbnMpIHRvIGJlIGRvd25sb2FkZWQuXG4gICAqXG4gICAqIEBkZWZhdWx0IC0gYWxsIGZpbGUgdHlwZXNcbiAgICovXG4gIHJlYWRvbmx5IGZpbGVUeXBlcz86IHN0cmluZ1tdO1xuICAvKipcbiAgICogU2NoZWR1bGUgdGhlIGNyYXdsZXIgdG8gcnVuIGV2ZXJ5IE4gaG91cnMgZm9sbG93aW5nIHRoZSBjb21wbGV0aW9uIG9mIHRoZSBwcmV2aW91cyBqb2IuXG4gICAqXG4gICAqIEBkZWZhdWx0IC0gbm90IHNjaGVkdWxlZFxuICAgKi9cbiAgcmVhZG9ubHkgY3Jhd2xJbnRlcnZhbEhvdXJzPzogbnVtYmVyO1xufVxuXG5leHBvcnQgaW50ZXJmYWNlIFdlYkNyYXdsZXJQcm9wcyB7XG4gIC8qKlxuICAgKiBWYWx1ZSB3aWxsIGJlIGFwcGVuZGVkIHRvIHJlc291cmNlcyBuYW1lLlxuICAgKlxuICAgKiBAZGVmYXVsdCAtIF9kZXZcbiAgICovXG4gIHJlYWRvbmx5IHN0YWdlPzogc3RyaW5nO1xuICAvKipcbiAgICogRW5hYmxlIG9ic2VydmFiaWxpdHkuIFdhcm5pbmc6IGFzc29jaWF0ZWQgY29zdCB3aXRoIHRoZSBzZXJ2aWNlc1xuICAgKiB1c2VkLiBCZXN0IHByYWN0aWNlIHRvIGVuYWJsZSBieSBkZWZhdWx0LlxuICAgKlxuICAgKiBAZGVmYXVsdCAtIHRydWVcbiAgICovXG4gIHJlYWRvbmx5IG9ic2VydmFiaWxpdHk/OiBib29sZWFuO1xuICAvKipcbiAgICogRXhpc3RpbmcgaW5zdGFuY2Ugb2YgUzMgQnVja2V0IG9iamVjdCwgcHJvdmlkaW5nIGJvdGggdGhpcyBhbmQgYGJ1Y2tldE91dHB1dFByb3BzYCB3aWxsIGNhdXNlIGFuIGVycm9yLlxuICAgKlxuICAgKiBAZGVmYXVsdCAtIE5vbmVcbiAgICovXG4gIHJlYWRvbmx5IGV4aXN0aW5nT3V0cHV0QnVja2V0T2JqPzogczMuSUJ1Y2tldDtcbiAgLyoqXG4gICAqIE9wdGlvbmFsIHVzZXIgcHJvdmlkZWQgcHJvcHMgdG8gb3ZlcnJpZGUgdGhlIGRlZmF1bHQgcHJvcHMgZm9yIHRoZSBTMyBCdWNrZXQuXG4gICAqIFByb3ZpZGluZyBib3RoIHRoaXMgYW5kIGBleGlzdGluZ091dHB1dEJ1Y2tldE9iamAgd2lsbCBjYXVzZSBhbiBlcnJvci5cbiAgICpcbiAgICogQGRlZmF1bHQgLSBEZWZhdWx0IHByb3BzIGFyZSB1c2VkXG4gICAqL1xuICByZWFkb25seSBidWNrZXRPdXRwdXRQcm9wcz86IHMzLkJ1Y2tldFByb3BzO1xuICAvKipcbiAgICogT3B0aW9uYWwgQW4gZXhpc3RpbmcgVlBDIGluIHdoaWNoIHRvIGRlcGxveSB0aGUgY29uc3RydWN0LiBQcm92aWRpbmcgYm90aCB0aGlzIGFuZFxuICAgKiB2cGNQcm9wcyBpcyBhbiBlcnJvci5cbiAgICpcbiAgICogQGRlZmF1bHQgLSBub25lXG4gICAqL1xuICByZWFkb25seSBleGlzdGluZ1ZwYz86IGVjMi5JVnBjO1xuICAvKipcbiAgICogT3B0aW9uYWwgY3VzdG9tIHByb3BlcnRpZXMgZm9yIGEgVlBDIHRoZSBjb25zdHJ1Y3Qgd2lsbCBjcmVhdGUuIFRoaXMgVlBDIHdpbGxcbiAgICogYmUgdXNlZCBieSB0aGUgY29tcHV0ZSByZXNvdXJjZXMgdGhlIGNvbnN0cnVjdCBjcmVhdGVzLiBQcm92aWRpbmdcbiAgICogYm90aCB0aGlzIGFuZCBleGlzdGluZ1ZwYyBpcyBhbiBlcnJvci5cbiAgICpcbiAgICogQGRlZmF1bHQgLSBub25lXG4gICAqL1xuICByZWFkb25seSB2cGNQcm9wcz86IGVjMi5WcGNQcm9wcztcbiAgLyoqXG4gICAqICBUYXJnZXRzIHRvIGJlIGNyYXdsZWQuXG4gICAqXG4gICAqIEBkZWZhdWx0IC0gbm9uZVxuICAgKi9cbiAgcmVhZG9ubHkgdGFyZ2V0cz86IENyYXdsZXJUYXJnZXRbXTtcbiAgLyoqXG4gICAqICBEZXBsb3kgTGFtYmRhIGNyYXdsZXIuXG4gICAqXG4gICAqIEBkZWZhdWx0IC0gZmFsc2VcbiAgICovXG4gIHJlYWRvbmx5IGVuYWJsZUxhbWJkYUNyYXdsZXI/OiBib29sZWFuO1xufVxuXG5leHBvcnQgZW51bSBDcmF3bGVyVGFyZ2V0VHlwZSB7XG4gIFdFQlNJVEUgPSAnd2Vic2l0ZScsXG4gIFJTU19GRUVEID0gJ3Jzc19mZWVkJyxcbn1cblxuZXhwb3J0IGNsYXNzIFdlYkNyYXdsZXIgZXh0ZW5kcyBCYXNlQ2xhc3Mge1xuICAvKipcbiAgICogUmV0dXJucyB0aGUgaW5zdGFuY2Ugb2YgZWMyLklWcGMgdXNlZCBieSB0aGUgY29uc3RydWN0XG4gICAqL1xuICBwdWJsaWMgcmVhZG9ubHkgdnBjOiBlYzIuSVZwYztcbiAgLyoqXG4gICAqIFJldHVybnMgdGhlIGluc3RhbmNlIG9mIFMzIGJ1Y2tldCB1c2VkIGJ5IHRoZSBjb25zdHJ1Y3RcbiAgICovXG4gIHB1YmxpYyByZWFkb25seSBkYXRhQnVja2V0OiBzMy5JQnVja2V0O1xuICAvKipcbiAgICogUmV0dXJucyB0aGUgaW5zdGFuY2Ugb2YgU05TIFRvcGljIHVzZWQgYnkgdGhlIGNvbnN0cnVjdFxuICAgKi9cbiAgcHVibGljIHJlYWRvbmx5IHNuc1RvcGljOiBzbnMuSVRvcGljO1xuICAvKipcbiAgICogUmV0dXJucyB0aGUgaW5zdGFuY2Ugb2YgVGFyZ2V0cyBEeW5hbW9EQiB0YWJsZVxuICAgKi9cbiAgcHVibGljIHJlYWRvbmx5IHRhcmdldHNUYWJsZTogZHluYW1vZGIuSVRhYmxlO1xuICAvKipcbiAgICogUmV0dXJucyB0aGUgaW5zdGFuY2Ugb2YgSm9icyBEeW5hbW9EQiB0YWJsZVxuICAgKi9cbiAgcHVibGljIHJlYWRvbmx5IGpvYnNUYWJsZTogZHluYW1vZGIuSVRhYmxlO1xuICAvKipcbiAgICogUmV0dXJucyB0aGUgaW5zdGFuY2Ugb2YgSm9iUXVldWUgdXNlZCBieSB0aGUgY29uc3RydWN0XG4gICAqL1xuICBwdWJsaWMgcmVhZG9ubHkgam9iUXVldWU6IGJhdGNoLklKb2JRdWV1ZTtcbiAgLyoqXG4gICAqIFJldHVybnMgdGhlIGluc3RhbmNlIG9mIEpvYkRlZmluaXRpb24gdXNlZCBieSB0aGUgY29uc3RydWN0XG4gICAqL1xuICBwdWJsaWMgcmVhZG9ubHkgd2ViQ3Jhd2xlckpvYkRlZmluaXRpb246IGJhdGNoLklKb2JEZWZpbml0aW9uO1xuICAvKipcbiAgICogTGFtYmRhIGNyYXdsZXJcbiAgICovXG4gIHB1YmxpYyByZWFkb25seSBsYW1iZGFDcmF3bGVyOiBsYW1iZGEuSUZ1bmN0aW9uIHwgdW5kZWZpbmVkO1xuICAvKipcbiAgICogTGFtYmRhIGNyYXdsZXIgQVBJIHNjaGVtYSBwYXRoXG4gICAqL1xuICBwdWJsaWMgcmVhZG9ubHkgbGFtYmRhQ3Jhd2xlckFwaVNjaGVtYVBhdGg6IHN0cmluZztcblxuICAvKipcbiAgICogQ29uc3RydWN0cyBhIG5ldyBpbnN0YW5jZSBvZiB0aGUgV2ViQ3Jhd2xlciBjbGFzcy5cbiAgICogQHBhcmFtIHtDb25zdHJ1Y3R9IHNjb3BlIC0gcmVwcmVzZW50cyB0aGUgc2NvcGUgZm9yIGFsbCB0aGUgcmVzb3VyY2VzLlxuICAgKiBAcGFyYW0ge3N0cmluZ30gaWQgLSB0aGlzIGlzIGEgYSBzY29wZS11bmlxdWUgaWQuXG4gICAqIEBwYXJhbSB7V2ViQ3Jhd2xlclByb3BzfSBwcm9wcyAtIHVzZXIgcHJvdmlkZWQgcHJvcHMgZm9yIHRoZSBjb25zdHJ1Y3QuXG4gICAqIEBzaW5jZSAwLjAuMFxuICAgKiBAcHVibGljXG4gICAqL1xuICBjb25zdHJ1Y3RvcihzY29wZTogQ29uc3RydWN0LCBpZDogc3RyaW5nLCBwcm9wczogV2ViQ3Jhd2xlclByb3BzKSB7XG4gICAgc3VwZXIoc2NvcGUsIGlkKTtcblxuICAgIHZwY19oZWxwZXIuQ2hlY2tWcGNQcm9wcyhwcm9wcyk7XG4gICAgczNfYnVja2V0X2hlbHBlci5DaGVja1MzUHJvcHMoe1xuICAgICAgZXhpc3RpbmdCdWNrZXRPYmo6IHByb3BzLmV4aXN0aW5nT3V0cHV0QnVja2V0T2JqLFxuICAgICAgYnVja2V0UHJvcHM6IHByb3BzLmJ1Y2tldE91dHB1dFByb3BzLFxuICAgIH0pO1xuXG4gICAgaWYgKHByb3BzPy5leGlzdGluZ1ZwYykge1xuICAgICAgdGhpcy52cGMgPSBwcm9wcy5leGlzdGluZ1ZwYztcbiAgICB9IGVsc2UgaWYgKHByb3BzLnZwY1Byb3BzKSB7XG4gICAgICB0aGlzLnZwYyA9IG5ldyBlYzIuVnBjKHRoaXMsICd3ZWJDcmF3bGVyVnBjJywgcHJvcHMudnBjUHJvcHMpO1xuICAgIH0gZWxzZSB7XG4gICAgICB0aGlzLnZwYyA9IG5ldyBlYzIuVnBjKHRoaXMsICd3ZWJDcmF3bGVyVnBjJywge1xuICAgICAgICBjcmVhdGVJbnRlcm5ldEdhdGV3YXk6IHRydWUsXG4gICAgICAgIG5hdEdhdGV3YXlzOiAxLFxuICAgICAgfSk7XG4gICAgfVxuXG4gICAgLy8gYWRkIFZQQyBlbmRwb2ludHMgZm9yIHRoZSBjb21wdXRlIGVudmlyb25tZW50XG4gICAgdnBjX2hlbHBlci5BZGRBd3NTZXJ2aWNlRW5kcG9pbnQodGhpcywgdGhpcy52cGMsIFNlcnZpY2VFbmRwb2ludFR5cGVFbnVtLkVDUl9BUEkpO1xuICAgIHZwY19oZWxwZXIuQWRkQXdzU2VydmljZUVuZHBvaW50KHRoaXMsIHRoaXMudnBjLCBTZXJ2aWNlRW5kcG9pbnRUeXBlRW51bS5FQ1JfREtSKTtcbiAgICB2cGNfaGVscGVyLkFkZEF3c1NlcnZpY2VFbmRwb2ludCh0aGlzLCB0aGlzLnZwYywgU2VydmljZUVuZHBvaW50VHlwZUVudW0uUzMpO1xuXG4gICAgLy8gdnBjIGZsb3dsb2dncm91cFxuICAgIGNvbnN0IGxvZ0dyb3VwID0gbmV3IGxvZ3MuTG9nR3JvdXAodGhpcywgJ3dlYkNyYXdsZXJDb25zdHJ1Y3RMb2dHcm91cCcpO1xuICAgIGNvbnN0IHJvbGUgPSBuZXcgaWFtLlJvbGUodGhpcywgJ3dlYkNyYXdsZXJDb25zdHJ1Y3RSb2xlJywge1xuICAgICAgYXNzdW1lZEJ5OiBuZXcgaWFtLlNlcnZpY2VQcmluY2lwYWwoJ3ZwYy1mbG93LWxvZ3MuYW1hem9uYXdzLmNvbScpLFxuICAgIH0pO1xuXG4gICAgLy8gdnBjIGZsb3dsb2dzXG4gICAgbmV3IGVjMi5GbG93TG9nKHRoaXMsICdGbG93TG9nJywge1xuICAgICAgcmVzb3VyY2VUeXBlOiBlYzIuRmxvd0xvZ1Jlc291cmNlVHlwZS5mcm9tVnBjKHRoaXMudnBjKSxcbiAgICAgIGRlc3RpbmF0aW9uOiBlYzIuRmxvd0xvZ0Rlc3RpbmF0aW9uLnRvQ2xvdWRXYXRjaExvZ3MobG9nR3JvdXAsIHJvbGUpLFxuICAgIH0pO1xuXG4gICAgY29uc3QgYmFzZVByb3BzOiBCYXNlQ2xhc3NQcm9wcyA9IHtcbiAgICAgIHN0YWdlOiBwcm9wcy5zdGFnZSxcbiAgICAgIGNvbnN0cnVjdE5hbWU6IENvbnN0cnVjdE5hbWUuQVdTV0VCQ1JBV0xFUixcbiAgICAgIGNvbnN0cnVjdElkOiBpZCxcbiAgICAgIG9ic2VydmFiaWxpdHk6IHByb3BzLm9ic2VydmFiaWxpdHksXG4gICAgfTtcblxuICAgIHRoaXMudXBkYXRlRW52U3VmZml4KGJhc2VQcm9wcyk7XG4gICAgdGhpcy5hZGRPYnNlcnZhYmlsaXR5VG9Db25zdHJ1Y3QoYmFzZVByb3BzKTtcblxuICAgIGNvbnN0IHRhcmdldHNUYWJsZSA9IG5ldyBkeW5hbW9kYi5UYWJsZSh0aGlzLCAndGFyZ2V0c1RhYmxlJywge1xuICAgICAgcGFydGl0aW9uS2V5OiB7IG5hbWU6ICd0YXJnZXRfdXJsJywgdHlwZTogZHluYW1vZGIuQXR0cmlidXRlVHlwZS5TVFJJTkcgfSxcbiAgICAgIGJpbGxpbmdNb2RlOiBkeW5hbW9kYi5CaWxsaW5nTW9kZS5QQVlfUEVSX1JFUVVFU1QsXG4gICAgICByZW1vdmFsUG9saWN5OiBjZGsuUmVtb3ZhbFBvbGljeS5ERVNUUk9ZLFxuICAgICAgcG9pbnRJblRpbWVSZWNvdmVyeTogdHJ1ZSxcbiAgICAgIGVuY3J5cHRpb246IGR5bmFtb2RiLlRhYmxlRW5jcnlwdGlvbi5BV1NfTUFOQUdFRCxcbiAgICB9KTtcblxuICAgIGNvbnN0IGpvYnNUYWJsZSA9IG5ldyBkeW5hbW9kYi5UYWJsZSh0aGlzLCAnam9ic1RhYmxlJywge1xuICAgICAgcGFydGl0aW9uS2V5OiB7IG5hbWU6ICd0YXJnZXRfdXJsJywgdHlwZTogZHluYW1vZGIuQXR0cmlidXRlVHlwZS5TVFJJTkcgfSxcbiAgICAgIHNvcnRLZXk6IHsgbmFtZTogJ2pvYl9pZCcsIHR5cGU6IGR5bmFtb2RiLkF0dHJpYnV0ZVR5cGUuU1RSSU5HIH0sXG4gICAgICBiaWxsaW5nTW9kZTogZHluYW1vZGIuQmlsbGluZ01vZGUuUEFZX1BFUl9SRVFVRVNULFxuICAgICAgcmVtb3ZhbFBvbGljeTogY2RrLlJlbW92YWxQb2xpY3kuREVTVFJPWSxcbiAgICAgIHBvaW50SW5UaW1lUmVjb3Zlcnk6IHRydWUsXG4gICAgICBlbmNyeXB0aW9uOiBkeW5hbW9kYi5UYWJsZUVuY3J5cHRpb24uQVdTX01BTkFHRUQsXG4gICAgfSk7XG5cbiAgICAvLyBidWNrZXQgZm9yIHN0b3Jpbmcgc2VydmVyIGFjY2VzcyBsb2dnaW5nXG4gICAgY29uc3Qgc2VydmVyQWNjZXNzTG9nQnVja2V0ID0gbmV3IHMzLkJ1Y2tldCh0aGlzLCAnc2VydmVyQWNjZXNzTG9nQnVja2V0JyArIHRoaXMuc3RhZ2UsIHtcbiAgICAgIGJsb2NrUHVibGljQWNjZXNzOiBzMy5CbG9ja1B1YmxpY0FjY2Vzcy5CTE9DS19BTEwsXG4gICAgICBlbmNyeXB0aW9uOiBzMy5CdWNrZXRFbmNyeXB0aW9uLlMzX01BTkFHRUQsXG4gICAgICBlbmZvcmNlU1NMOiB0cnVlLFxuICAgICAgdmVyc2lvbmVkOiB0cnVlLFxuICAgICAgbGlmZWN5Y2xlUnVsZXM6IFtcbiAgICAgICAge1xuICAgICAgICAgIGV4cGlyYXRpb246IGNkay5EdXJhdGlvbi5kYXlzKDkwKSxcbiAgICAgICAgfSxcbiAgICAgIF0sXG4gICAgfSk7XG5cbiAgICAvLyBCdWNrZXQgY29udGFpbmluZyB0aGUgb3V0cHV0IGRhdGEgdXBsb2FkZWQgYnkgdGhlIGNyYXdsZXJcbiAgICBsZXQgZGF0YUJ1Y2tldDogczMuSUJ1Y2tldDtcblxuICAgIGlmICghcHJvcHMuZXhpc3RpbmdPdXRwdXRCdWNrZXRPYmopIHtcbiAgICAgIGxldCB0bXBCdWNrZXQ6IHMzLkJ1Y2tldDtcbiAgICAgIGlmICghcHJvcHMuYnVja2V0T3V0cHV0UHJvcHMpIHtcbiAgICAgICAgdG1wQnVja2V0ID0gbmV3IHMzLkJ1Y2tldCh0aGlzLCAnd2ViQ3Jhd2xlckRhdGFCdWNrZXQnICsgdGhpcy5zdGFnZSwge1xuICAgICAgICAgIGFjY2Vzc0NvbnRyb2w6IHMzLkJ1Y2tldEFjY2Vzc0NvbnRyb2wuUFJJVkFURSxcbiAgICAgICAgICBibG9ja1B1YmxpY0FjY2VzczogczMuQmxvY2tQdWJsaWNBY2Nlc3MuQkxPQ0tfQUxMLFxuICAgICAgICAgIGVuY3J5cHRpb246IHMzLkJ1Y2tldEVuY3J5cHRpb24uUzNfTUFOQUdFRCxcbiAgICAgICAgICBidWNrZXROYW1lOiAnb3V0cHV0YnVja2V0JyArIHRoaXMuc3RhZ2UudG9Mb3dlckNhc2UoKSArICctJyArIGNkay5Bd3MuUkVHSU9OICsgJy0nICsgY2RrLkF3cy5BQ0NPVU5UX0lELFxuICAgICAgICAgIHNlcnZlckFjY2Vzc0xvZ3NCdWNrZXQ6IHNlcnZlckFjY2Vzc0xvZ0J1Y2tldCxcbiAgICAgICAgICBlbmZvcmNlU1NMOiB0cnVlLFxuICAgICAgICAgIHZlcnNpb25lZDogdHJ1ZSxcbiAgICAgICAgICBsaWZlY3ljbGVSdWxlczogW1xuICAgICAgICAgICAge1xuICAgICAgICAgICAgICBleHBpcmF0aW9uOiBjZGsuRHVyYXRpb24uZGF5cyg5MCksXG4gICAgICAgICAgICB9LFxuICAgICAgICAgIF0sXG4gICAgICAgIH0pO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgdG1wQnVja2V0ID0gbmV3IHMzLkJ1Y2tldCh0aGlzLCAnd2ViQ3Jhd2xlckRhdGFCdWNrZXQnICsgdGhpcy5zdGFnZSwgcHJvcHMuYnVja2V0T3V0cHV0UHJvcHMpO1xuICAgICAgfVxuICAgICAgZGF0YUJ1Y2tldCA9IHRtcEJ1Y2tldDtcbiAgICAgIHRoaXMuZGF0YUJ1Y2tldCA9IHRtcEJ1Y2tldDtcbiAgICB9IGVsc2Uge1xuICAgICAgZGF0YUJ1Y2tldCA9IHByb3BzLmV4aXN0aW5nT3V0cHV0QnVja2V0T2JqO1xuICAgIH1cblxuICAgIGNvbnN0IHNuc1RvcGljID0gbmV3IHNucy5Ub3BpYyh0aGlzLCAnd2ViQ3Jhd2xlclRvcGljJywge1xuICAgICAgbWFzdGVyS2V5OiBrbXMuQWxpYXMuZnJvbUFsaWFzTmFtZShzY29wZSwgJ2F3cy1tYW5hZ2VkLWtleScsICdhbGlhcy9hd3Mvc25zJyksXG4gICAgfSk7XG5cbiAgICAvLyBBcHBseSB0b3BpYyBwb2xpY3kgdG8gZW5mb3JjZSBvbmx5IHRoZSB0b3BpYyBvd25lciBjYW4gcHVibGlzaCBhbmQgc3Vic2NyaWJlIHRvIHRoaXMgdG9waWNcbiAgICBzbnNUb3BpYy5hZGRUb1Jlc291cmNlUG9saWN5KFxuICAgICAgbmV3IFBvbGljeVN0YXRlbWVudCh7XG4gICAgICAgIHNpZDogJ1RvcGljT3duZXJPbmx5QWNjZXNzJyxcbiAgICAgICAgcmVzb3VyY2VzOiBbYCR7c25zVG9waWMudG9waWNBcm59YF0sXG4gICAgICAgIGFjdGlvbnM6IFtcbiAgICAgICAgICAnU05TOlB1Ymxpc2gnLFxuICAgICAgICAgICdTTlM6UmVtb3ZlUGVybWlzc2lvbicsXG4gICAgICAgICAgJ1NOUzpTZXRUb3BpY0F0dHJpYnV0ZXMnLFxuICAgICAgICAgICdTTlM6RGVsZXRlVG9waWMnLFxuICAgICAgICAgICdTTlM6TGlzdFN1YnNjcmlwdGlvbnNCeVRvcGljJyxcbiAgICAgICAgICAnU05TOkdldFRvcGljQXR0cmlidXRlcycsXG4gICAgICAgICAgJ1NOUzpSZWNlaXZlJyxcbiAgICAgICAgICAnU05TOkFkZFBlcm1pc3Npb24nLFxuICAgICAgICAgICdTTlM6U3Vic2NyaWJlJyxcbiAgICAgICAgXSxcbiAgICAgICAgcHJpbmNpcGFsczogW25ldyBBY2NvdW50UHJpbmNpcGFsKGNkay5TdGFjay5vZihzbnNUb3BpYykuYWNjb3VudCldLFxuICAgICAgICBlZmZlY3Q6IEVmZmVjdC5BTExPVyxcbiAgICAgICAgY29uZGl0aW9uczoge1xuICAgICAgICAgIFN0cmluZ0VxdWFsczoge1xuICAgICAgICAgICAgJ0FXUzpTb3VyY2VPd25lcic6IGNkay5TdGFjay5vZihzbnNUb3BpYykuYWNjb3VudCxcbiAgICAgICAgICB9LFxuICAgICAgICB9LFxuICAgICAgfSksXG4gICAgKTtcblxuICAgIC8vIEFwcGx5IFRvcGljIHBvbGljeSB0byBlbmZvcmNlIGVuY3J5cHRpb24gb2YgZGF0YSBpbiB0cmFuc2l0XG4gICAgc25zVG9waWMuYWRkVG9SZXNvdXJjZVBvbGljeShcbiAgICAgIG5ldyBQb2xpY3lTdGF0ZW1lbnQoe1xuICAgICAgICBzaWQ6ICdIdHRwc09ubHknLFxuICAgICAgICByZXNvdXJjZXM6IFtgJHtzbnNUb3BpYy50b3BpY0Fybn1gXSxcbiAgICAgICAgYWN0aW9uczogW1xuICAgICAgICAgICdTTlM6UHVibGlzaCcsXG4gICAgICAgICAgJ1NOUzpSZW1vdmVQZXJtaXNzaW9uJyxcbiAgICAgICAgICAnU05TOlNldFRvcGljQXR0cmlidXRlcycsXG4gICAgICAgICAgJ1NOUzpEZWxldGVUb3BpYycsXG4gICAgICAgICAgJ1NOUzpMaXN0U3Vic2NyaXB0aW9uc0J5VG9waWMnLFxuICAgICAgICAgICdTTlM6R2V0VG9waWNBdHRyaWJ1dGVzJyxcbiAgICAgICAgICAnU05TOlJlY2VpdmUnLFxuICAgICAgICAgICdTTlM6QWRkUGVybWlzc2lvbicsXG4gICAgICAgICAgJ1NOUzpTdWJzY3JpYmUnLFxuICAgICAgICBdLFxuICAgICAgICBwcmluY2lwYWxzOiBbbmV3IEFueVByaW5jaXBhbCgpXSxcbiAgICAgICAgZWZmZWN0OiBFZmZlY3QuREVOWSxcbiAgICAgICAgY29uZGl0aW9uczoge1xuICAgICAgICAgIEJvb2w6IHtcbiAgICAgICAgICAgICdhd3M6U2VjdXJlVHJhbnNwb3J0JzogJ2ZhbHNlJyxcbiAgICAgICAgICB9LFxuICAgICAgICB9LFxuICAgICAgfSksXG4gICAgKTtcblxuICAgIGNvbnN0IGNvbXB1dGVFbnZpcm9ubWVudCA9IG5ldyBiYXRjaC5GYXJnYXRlQ29tcHV0ZUVudmlyb25tZW50KHRoaXMsICd3ZWJDcmF3bGVyRW52aXJvbm1lbnQnLCB7XG4gICAgICB2cGM6IHRoaXMudnBjLFxuICAgICAgbWF4dkNwdXM6IDgsXG4gICAgICByZXBsYWNlQ29tcHV0ZUVudmlyb25tZW50OiB0cnVlLFxuICAgICAgdXBkYXRlVGltZW91dDogY2RrLkR1cmF0aW9uLm1pbnV0ZXMoMzApLFxuICAgICAgdXBkYXRlVG9MYXRlc3RJbWFnZVZlcnNpb246IHRydWUsXG4gICAgICB2cGNTdWJuZXRzOiB7IHN1Ym5ldFR5cGU6IGVjMi5TdWJuZXRUeXBlLlBSSVZBVEVfV0lUSF9FR1JFU1MgfSxcbiAgICB9KTtcblxuICAgIGNvbnN0IGpvYlF1ZXVlID0gbmV3IGJhdGNoLkpvYlF1ZXVlKHRoaXMsICd3ZWJDcmF3bGVySm9iUXVldWUnLCB7XG4gICAgICBjb21wdXRlRW52aXJvbm1lbnRzOiBbXG4gICAgICAgIHtcbiAgICAgICAgICBjb21wdXRlRW52aXJvbm1lbnQsXG4gICAgICAgICAgb3JkZXI6IDEsXG4gICAgICAgIH0sXG4gICAgICBdLFxuICAgICAgcHJpb3JpdHk6IDEsXG4gICAgfSk7XG5cbiAgICBjb25zdCB3ZWJDcmF3bGVySm9iUm9sZSA9IG5ldyBpYW0uUm9sZSh0aGlzLCAnd2ViQ3Jhd2xlckpvYlJvbGUnLCB7XG4gICAgICBhc3N1bWVkQnk6IG5ldyBpYW0uU2VydmljZVByaW5jaXBhbCgnZWNzLXRhc2tzLmFtYXpvbmF3cy5jb20nKSxcbiAgICAgIGlubGluZVBvbGljaWVzOiB7XG4gICAgICAgIEZhcmdhdGVDb250YWluZXJTZXJ2aWNlUm9sZVBvbGljeTogbmV3IGlhbS5Qb2xpY3lEb2N1bWVudCh7XG4gICAgICAgICAgc3RhdGVtZW50czogW1xuICAgICAgICAgICAgbmV3IGlhbS5Qb2xpY3lTdGF0ZW1lbnQoe1xuICAgICAgICAgICAgICBhY3Rpb25zOiBbJ2VjcjpCYXRjaENoZWNrTGF5ZXJBdmFpbGFiaWxpdHknLCAnZWNyOkdldERvd25sb2FkVXJsRm9yTGF5ZXInLCAnZWNyOkJhdGNoR2V0SW1hZ2UnXSxcbiAgICAgICAgICAgICAgZWZmZWN0OiBpYW0uRWZmZWN0LkFMTE9XLFxuICAgICAgICAgICAgICByZXNvdXJjZXM6IFsnYXJuOicgKyBjZGsuQXdzLlBBUlRJVElPTiArICc6ZWNyOicgKyBjZGsuQXdzLlJFR0lPTiArICc6JyArIGNkay5Bd3MuQUNDT1VOVF9JRCArICc6cmVwb3NpdG9yeS8qJ10sXG4gICAgICAgICAgICB9KSxcbiAgICAgICAgICAgIG5ldyBpYW0uUG9saWN5U3RhdGVtZW50KHtcbiAgICAgICAgICAgICAgYWN0aW9uczogWydlY3I6R2V0QXV0aG9yaXphdGlvblRva2VuJ10sXG4gICAgICAgICAgICAgIGVmZmVjdDogaWFtLkVmZmVjdC5BTExPVyxcbiAgICAgICAgICAgICAgcmVzb3VyY2VzOiBbJyonXSxcbiAgICAgICAgICAgIH0pLFxuICAgICAgICAgICAgbmV3IGlhbS5Qb2xpY3lTdGF0ZW1lbnQoe1xuICAgICAgICAgICAgICBhY3Rpb25zOiBbJ2xvZ3M6Q3JlYXRlTG9nU3RyZWFtJywgJ2xvZ3M6UHV0TG9nRXZlbnRzJ10sXG4gICAgICAgICAgICAgIGVmZmVjdDogaWFtLkVmZmVjdC5BTExPVyxcbiAgICAgICAgICAgICAgcmVzb3VyY2VzOiBbJ2FybjonICsgY2RrLkF3cy5QQVJUSVRJT04gKyAnOmxvZ3M6JyArIGNkay5Bd3MuUkVHSU9OICsgJzonICsgY2RrLkF3cy5BQ0NPVU5UX0lEICsgJzpsb2ctZ3JvdXA6KiddLFxuICAgICAgICAgICAgfSksXG4gICAgICAgICAgXSxcbiAgICAgICAgfSksXG4gICAgICB9LFxuICAgIH0pO1xuXG4gICAgY29uc3Qgd2ViQ3Jhd2xlckNvbnRhaW5lciA9IG5ldyBiYXRjaC5FY3NGYXJnYXRlQ29udGFpbmVyRGVmaW5pdGlvbih0aGlzLCAnd2ViQ3Jhd2xlckNvbnRhaW5lcicsIHtcbiAgICAgIGNwdTogMixcbiAgICAgIG1lbW9yeTogY2RrLlNpemUubWViaWJ5dGVzKDYxNDQpLFxuICAgICAgaW1hZ2U6IGVjcy5Db250YWluZXJJbWFnZS5mcm9tQXNzZXQocGF0aC5qb2luKF9fZGlybmFtZSwgJy4uLy4uLy4uLy4uL3Jlc291cmNlcy9nZW4tYWkvYXdzLXdlYi1jcmF3bGVyLWNvbnRhaW5lcicpLCB7XG4gICAgICAgIHBsYXRmb3JtOiBhd3NfZWNyX2Fzc2V0cy5QbGF0Zm9ybS5MSU5VWF9BTUQ2NCxcbiAgICAgIH0pLFxuICAgICAgam9iUm9sZTogd2ViQ3Jhd2xlckpvYlJvbGUsXG4gICAgICBlbnZpcm9ubWVudDoge1xuICAgICAgICBBV1NfREVGQVVMVF9SRUdJT046IGNkay5TdGFjay5vZih0aGlzKS5yZWdpb24sXG4gICAgICAgIFRBUkdFVFNfVEFCTEVfTkFNRTogdGFyZ2V0c1RhYmxlLnRhYmxlTmFtZSxcbiAgICAgICAgSk9CU19UQUJMRV9OQU1FOiBqb2JzVGFibGUudGFibGVOYW1lLFxuICAgICAgICBEQVRBX0JVQ0tFVF9OQU1FOiBkYXRhQnVja2V0LmJ1Y2tldE5hbWUsXG4gICAgICAgIFNOU19UT1BJQ19BUk46IHNuc1RvcGljLnRvcGljQXJuLFxuICAgICAgfSxcbiAgICB9KTtcblxuICAgIHRhcmdldHNUYWJsZS5ncmFudFJlYWRXcml0ZURhdGEod2ViQ3Jhd2xlckpvYlJvbGUpO1xuICAgIGpvYnNUYWJsZS5ncmFudFJlYWRXcml0ZURhdGEod2ViQ3Jhd2xlckpvYlJvbGUpO1xuICAgIGRhdGFCdWNrZXQuZ3JhbnRSZWFkV3JpdGUod2ViQ3Jhd2xlckpvYlJvbGUpO1xuICAgIHNuc1RvcGljLmdyYW50UHVibGlzaCh3ZWJDcmF3bGVySm9iUm9sZSk7XG5cbiAgICBOYWdTdXBwcmVzc2lvbnMuYWRkUmVzb3VyY2VTdXBwcmVzc2lvbnMoXG4gICAgICB3ZWJDcmF3bGVyQ29udGFpbmVyLmV4ZWN1dGlvblJvbGUsXG4gICAgICBbXG4gICAgICAgIHtcbiAgICAgICAgICBpZDogJ0F3c1NvbHV0aW9ucy1JQU01JyxcbiAgICAgICAgICByZWFzb246ICdDREsgQ3VzdG9tUmVzb3VyY2UgUHJvdmlkZXIgaGFzIGEgd2lsZGNhcmQgdG8gaW52b2tlIGFueSB2ZXJzaW9uIG9mIHRoZSBzcGVjaWZpYyBDdXN0b20gUmVzb3VyY2UgZnVuY3Rpb24uJyxcbiAgICAgICAgfSxcbiAgICAgIF0sXG4gICAgICB0cnVlLFxuICAgICk7XG5cbiAgICBOYWdTdXBwcmVzc2lvbnMuYWRkUmVzb3VyY2VTdXBwcmVzc2lvbnMod2ViQ3Jhd2xlckNvbnRhaW5lci5leGVjdXRpb25Sb2xlLCBbXG4gICAgICB7XG4gICAgICAgIGlkOiAnQXdzU29sdXRpb25zLUlBTTQnLFxuICAgICAgICByZWFzb246XG4gICAgICAgICAgJ1RoZSBBV1NMYW1iZGFCYXNpY0V4ZWN1dGlvblJvbGUgbWFuYWdlZCBwb2xpY3kgaXMgcmVxdWlyZWQgZm9yICcgKyAndGhlIExhbWJkYSBmdW5jdGlvbiB0byB3cml0ZSBsb2dzIHRvIENsb3VkV2F0Y2guJyxcbiAgICAgIH0sXG4gICAgXSk7XG5cbiAgICBOYWdTdXBwcmVzc2lvbnMuYWRkUmVzb3VyY2VTdXBwcmVzc2lvbnMoXG4gICAgICB3ZWJDcmF3bGVySm9iUm9sZSxcbiAgICAgIFtcbiAgICAgICAge1xuICAgICAgICAgIGlkOiAnQXdzU29sdXRpb25zLUlBTTUnLFxuICAgICAgICAgIHJlYXNvbjogJ0NESyBDdXN0b21SZXNvdXJjZSBQcm92aWRlciBoYXMgYSB3aWxkY2FyZCB0byBpbnZva2UgYW55IHZlcnNpb24gb2YgdGhlIHNwZWNpZmljIEN1c3RvbSBSZXNvdXJjZSBmdW5jdGlvbi4nLFxuICAgICAgICB9LFxuICAgICAgXSxcbiAgICAgIHRydWUsXG4gICAgKTtcblxuICAgIE5hZ1N1cHByZXNzaW9ucy5hZGRSZXNvdXJjZVN1cHByZXNzaW9ucyh3ZWJDcmF3bGVySm9iUm9sZSwgW1xuICAgICAge1xuICAgICAgICBpZDogJ0F3c1NvbHV0aW9ucy1JQU00JyxcbiAgICAgICAgcmVhc29uOlxuICAgICAgICAgICdUaGUgQVdTTGFtYmRhQmFzaWNFeGVjdXRpb25Sb2xlIG1hbmFnZWQgcG9saWN5IGlzIHJlcXVpcmVkIGZvciAnICsgJ3RoZSBMYW1iZGEgZnVuY3Rpb24gdG8gd3JpdGUgbG9ncyB0byBDbG91ZFdhdGNoLicsXG4gICAgICB9LFxuICAgIF0pO1xuXG4gICAgY29uc3Qgd2ViQ3Jhd2xlckpvYkRlZmluaXRpb24gPSBuZXcgYmF0Y2guRWNzSm9iRGVmaW5pdGlvbih0aGlzLCAnd2ViQ3Jhd2xlckpvYicsIHtcbiAgICAgIGNvbnRhaW5lcjogd2ViQ3Jhd2xlckNvbnRhaW5lcixcbiAgICAgIHJldHJ5QXR0ZW1wdHM6IDEsXG4gICAgICB0aW1lb3V0OiBjZGsuRHVyYXRpb24uaG91cnMoNDgpLFxuICAgICAgcmV0cnlTdHJhdGVnaWVzOiBbXG4gICAgICAgIGJhdGNoLlJldHJ5U3RyYXRlZ3kub2YoYmF0Y2guQWN0aW9uLkVYSVQsIGJhdGNoLlJlYXNvbi5DQU5OT1RfUFVMTF9DT05UQUlORVIpLFxuICAgICAgICBiYXRjaC5SZXRyeVN0cmF0ZWd5Lm9mKFxuICAgICAgICAgIGJhdGNoLkFjdGlvbi5FWElULFxuICAgICAgICAgIGJhdGNoLlJlYXNvbi5jdXN0b20oe1xuICAgICAgICAgICAgb25FeGl0Q29kZTogJzEzNycsXG4gICAgICAgICAgfSksXG4gICAgICAgICksXG4gICAgICBdLFxuICAgIH0pO1xuXG4gICAgZm9yIChjb25zdCB0YXJnZXQgb2YgcHJvcHMudGFyZ2V0cyA/PyBbXSkge1xuICAgICAgbGV0IHRhcmdldFVybCA9IHRhcmdldC51cmwudHJpbSgpO1xuICAgICAgaWYgKCEvXmh0dHBzPzpcXC9cXC8vLnRlc3QodGFyZ2V0VXJsLnRvTG93ZXJDYXNlKCkpKSB7XG4gICAgICAgIHRhcmdldFVybCA9IGBodHRwczovLyR7dGFyZ2V0VXJsfWA7XG4gICAgICB9XG5cbiAgICAgIGxldCB0YXJnZXRfczNfa2V5ID0gZW5jb2RlVVJJQ29tcG9uZW50KHVybC5wYXJzZSh0YXJnZXRVcmwpLmhvc3RuYW1lPy5yZXBsYWNlKC9cXC4vZywgJy0nKS5zdWJzdHJpbmcoMCwgMzApID8/IHRhcmdldFVybCk7XG4gICAgICBjb25zdCBoYXNoID0gY3J5cHRvXG4gICAgICAgIC5jcmVhdGVIYXNoKCdzaGEyNTYnKVxuICAgICAgICAudXBkYXRlKHRhcmdldFVybClcbiAgICAgICAgLmRpZ2VzdCgnYmFzZTY0JylcbiAgICAgICAgLnJlcGxhY2UoL1xcKy9nLCAnLScpXG4gICAgICAgIC5yZXBsYWNlKC9cXC8vZywgJ18nKVxuICAgICAgICAuc3Vic3RyaW5nKDAsIDEyKTtcbiAgICAgIHRhcmdldF9zM19rZXkgPSBgJHt0YXJnZXRfczNfa2V5fS0ke2hhc2h9YDtcblxuICAgICAgbmV3IGNyLkF3c0N1c3RvbVJlc291cmNlKHRoaXMsIGB0YXJnZXQtJHt0YXJnZXRfczNfa2V5fWAsIHtcbiAgICAgICAgb25DcmVhdGU6IHtcbiAgICAgICAgICBzZXJ2aWNlOiAnRHluYW1vREInLFxuICAgICAgICAgIGFjdGlvbjogJ3B1dEl0ZW0nLFxuICAgICAgICAgIHBhcmFtZXRlcnM6IHtcbiAgICAgICAgICAgIFRhYmxlTmFtZTogdGFyZ2V0c1RhYmxlLnRhYmxlQXJuLFxuICAgICAgICAgICAgSXRlbToge1xuICAgICAgICAgICAgICB0YXJnZXRfdXJsOiB7IFM6IHRhcmdldFVybCB9LFxuICAgICAgICAgICAgICB0YXJnZXRfczNfa2V5OiB7IFM6IHRhcmdldF9zM19rZXkgfSxcbiAgICAgICAgICAgICAgdGFyZ2V0X3R5cGU6IHsgUzogdGFyZ2V0LnRhcmdldFR5cGUgfSxcbiAgICAgICAgICAgICAgc2l0ZW1hcHM6IHsgTDogW10gfSxcbiAgICAgICAgICAgICAgbWF4X3JlcXVlc3RzOiB7IE46IGAke3RhcmdldC5tYXhSZXF1ZXN0cyA/PyAwfWAgfSxcbiAgICAgICAgICAgICAgbWF4X2ZpbGVzOiB7IE46IGAke3RhcmdldC5tYXhGaWxlcyA/PyAwfWAgfSxcbiAgICAgICAgICAgICAgZG93bmxvYWRfZmlsZXM6IHsgQk9PTDogdGFyZ2V0LmRvd25sb2FkRmlsZXMgPz8gdHJ1ZSB9LFxuICAgICAgICAgICAgICBmaWxlX3R5cGVzOiB7IEw6IHRhcmdldC5maWxlVHlwZXMgPz8gW10gfSxcbiAgICAgICAgICAgICAgY3Jhd2xfaW50ZXJ2YWxfaG91cnM6IHsgTjogYCR7dGFyZ2V0LmNyYXdsSW50ZXJ2YWxIb3VycyA/PyAwfWAgfSxcbiAgICAgICAgICAgICAgbGFzdF9maW5pc2hlZF9qb2JfaWQ6IHsgUzogJycgfSxcbiAgICAgICAgICAgICAgbGFzdF9maW5pc2hlZF9qb2JfZGF0ZTogeyBTOiAnJyB9LFxuICAgICAgICAgICAgICBjcmVhdGVkX2F0OiB7IE46IGAke0RhdGUubm93KCl9YCB9LFxuICAgICAgICAgICAgICB1cGRhdGVkX2F0OiB7IE46IGAke0RhdGUubm93KCl9YCB9LFxuICAgICAgICAgICAgfSxcbiAgICAgICAgICB9LFxuICAgICAgICAgIHBoeXNpY2FsUmVzb3VyY2VJZDogY3IuUGh5c2ljYWxSZXNvdXJjZUlkLm9mKHRhcmdldFVybCksXG4gICAgICAgIH0sXG4gICAgICAgIG9uVXBkYXRlOiB7XG4gICAgICAgICAgc2VydmljZTogJ0R5bmFtb0RCJyxcbiAgICAgICAgICBhY3Rpb246ICd1cGRhdGVJdGVtJyxcbiAgICAgICAgICBwYXJhbWV0ZXJzOiB7XG4gICAgICAgICAgICBUYWJsZU5hbWU6IHRhcmdldHNUYWJsZS50YWJsZUFybixcbiAgICAgICAgICAgIEtleToge1xuICAgICAgICAgICAgICB0YXJnZXRfdXJsOiB7IFM6IHRhcmdldFVybCB9LFxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIFVwZGF0ZUV4cHJlc3Npb246XG4gICAgICAgICAgICAgICdTRVQgdGFyZ2V0X3R5cGUgPSA6dGFyZ2V0X3R5cGUsIG1heF9yZXF1ZXN0cyA9IDptYXhfcmVxdWVzdHMsIG1heF9maWxlcyA9IDptYXhfZmlsZXMsIGRvd25sb2FkX2ZpbGVzID0gOmRvd25sb2FkX2ZpbGVzLCBmaWxlX3R5cGVzID0gOmZpbGVfdHlwZXMsIGNyYXdsX2ludGVydmFsX2hvdXJzID0gOmNyYXdsX2ludGVydmFsX2hvdXJzJyxcbiAgICAgICAgICAgIEV4cHJlc3Npb25BdHRyaWJ1dGVWYWx1ZXM6IHtcbiAgICAgICAgICAgICAgJzp0YXJnZXRfdHlwZSc6IHsgUzogdGFyZ2V0LnRhcmdldFR5cGUgfSxcbiAgICAgICAgICAgICAgJzptYXhfcmVxdWVzdHMnOiB7IE46IGAke3RhcmdldC5tYXhSZXF1ZXN0cyA/PyAwfWAgfSxcbiAgICAgICAgICAgICAgJzptYXhfZmlsZXMnOiB7IE46IGAke3RhcmdldC5tYXhGaWxlcyA/PyAwfWAgfSxcbiAgICAgICAgICAgICAgJzpkb3dubG9hZF9maWxlcyc6IHsgQk9PTDogdGFyZ2V0LmRvd25sb2FkRmlsZXMgPz8gdHJ1ZSB9LFxuICAgICAgICAgICAgICAnOmZpbGVfdHlwZXMnOiB7IEw6IHRhcmdldC5maWxlVHlwZXMgPz8gW10gfSxcbiAgICAgICAgICAgICAgJzpjcmF3bF9pbnRlcnZhbF9ob3Vycyc6IHsgTjogYCR7dGFyZ2V0LmNyYXdsSW50ZXJ2YWxIb3VycyA/PyAwfWAgfSxcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBSZXR1cm5WYWx1ZXM6ICdVUERBVEVEX05FVycsXG4gICAgICAgICAgfSxcbiAgICAgICAgfSxcbiAgICAgICAgb25EZWxldGU6IHtcbiAgICAgICAgICBzZXJ2aWNlOiAnRHluYW1vREInLFxuICAgICAgICAgIGFjdGlvbjogJ2RlbGV0ZUl0ZW0nLFxuICAgICAgICAgIHBhcmFtZXRlcnM6IHtcbiAgICAgICAgICAgIFRhYmxlTmFtZTogdGFyZ2V0c1RhYmxlLnRhYmxlQXJuLFxuICAgICAgICAgICAgS2V5OiB7XG4gICAgICAgICAgICAgIHRhcmdldF91cmw6IHsgUzogdGFyZ2V0VXJsIH0sXG4gICAgICAgICAgICB9LFxuICAgICAgICAgIH0sXG4gICAgICAgIH0sXG4gICAgICAgIHBvbGljeTogY3IuQXdzQ3VzdG9tUmVzb3VyY2VQb2xpY3kuZnJvbVN0YXRlbWVudHMoW1xuICAgICAgICAgIG5ldyBpYW0uUG9saWN5U3RhdGVtZW50KHtcbiAgICAgICAgICAgIGFjdGlvbnM6IFsnZHluYW1vZGI6UHV0SXRlbScsICdkeW5hbW9kYjpHZXRJdGVtJywgJ2R5bmFtb2RiOkRlbGV0ZUl0ZW0nLCAnZHluYW1vZGI6VXBkYXRlSXRlbSddLFxuICAgICAgICAgICAgcmVzb3VyY2VzOiBbdGFyZ2V0c1RhYmxlLnRhYmxlQXJuXSxcbiAgICAgICAgICB9KSxcbiAgICAgICAgXSksXG4gICAgICB9KTtcblxuICAgICAgTmFnU3VwcHJlc3Npb25zLmFkZFJlc291cmNlU3VwcHJlc3Npb25zQnlQYXRoKFxuICAgICAgICBjZGsuU3RhY2sub2YodGhpcyksXG4gICAgICAgIGAke2Nkay5TdGFjay5vZih0aGlzKS5zdGFja05hbWV9L0FXUyR7Y3IuQXdzQ3VzdG9tUmVzb3VyY2UuUFJPVklERVJfRlVOQ1RJT05fVVVJRC5yZXBsYWNlKFxuICAgICAgICAgIC8tL2csXG4gICAgICAgICAgJycsXG4gICAgICAgICl9L1NlcnZpY2VSb2xlL1Jlc291cmNlYCxcbiAgICAgICAgW1xuICAgICAgICAgIHtcbiAgICAgICAgICAgIGlkOiAnQXdzU29sdXRpb25zLUlBTTQnLFxuICAgICAgICAgICAgcmVhc29uOiAnQ0RLIEN1c3RvbVJlc291cmNlIExhbWJkYSB1c2VzIHRoZSBBV1NMYW1iZGFCYXNpY0V4ZWN1dGlvblJvbGUgQVdTIE1hbmFnZWQgUG9saWN5LicsXG4gICAgICAgICAgfSxcbiAgICAgICAgXSxcbiAgICAgICk7XG5cbiAgICAgIE5hZ1N1cHByZXNzaW9ucy5hZGRSZXNvdXJjZVN1cHByZXNzaW9uc0J5UGF0aChcbiAgICAgICAgY2RrLlN0YWNrLm9mKHRoaXMpLFxuICAgICAgICBgJHtjZGsuU3RhY2sub2YodGhpcykuc3RhY2tOYW1lfS9BV1Mke2NyLkF3c0N1c3RvbVJlc291cmNlLlBST1ZJREVSX0ZVTkNUSU9OX1VVSUQucmVwbGFjZSgvLS9nLCAnJyl9L1Jlc291cmNlYCxcbiAgICAgICAgW1xuICAgICAgICAgIHtcbiAgICAgICAgICAgIGlkOiAnQXdzU29sdXRpb25zLUwxJyxcbiAgICAgICAgICAgIHJlYXNvbjogJ0xhbWJkYSBydW50aW1lIHZlcnNpb24gaXMgbWFuYWdlZCB1cHN0cmVhbSBieSBDREsuJyxcbiAgICAgICAgICB9LFxuICAgICAgICBdLFxuICAgICAgKTtcbiAgICB9XG5cbiAgICBjb25zdCBzY2hlZHVsZXJGdW5jdGlvbiA9IG5ldyBsYW1iZGEuRnVuY3Rpb24odGhpcywgJ3dlYkNyYXdsZXJTY2hlZHVsZXJGdW5jdGlvbicsIHtcbiAgICAgIHJ1bnRpbWU6IGxhbWJkYS5SdW50aW1lLlBZVEhPTl8zXzEyLFxuICAgICAgaGFuZGxlcjogJ2xhbWJkYS5oYW5kbGVyJyxcbiAgICAgIGZ1bmN0aW9uTmFtZTogJ2xhbWJkYV9jcmF3bGVyX3NjaGVkdWxlcicgKyB0aGlzLnN0YWdlLFxuICAgICAgdHJhY2luZzogdGhpcy5sYW1iZGFUcmFjaW5nLFxuICAgICAgdGltZW91dDogY2RrLkR1cmF0aW9uLm1pbnV0ZXMoMTUpLFxuICAgICAgbWVtb3J5U2l6ZTogMjU2LFxuICAgICAgY29kZTogbGFtYmRhLkNvZGUuZnJvbUFzc2V0KHBhdGguam9pbihfX2Rpcm5hbWUsICcuLi8uLi8uLi8uLi9sYW1iZGEvYXdzLXdlYi1jcmF3bGVyLXNjaGVkdWxlcicpKSxcbiAgICAgIGxvZ0dyb3VwOiBuZXcgbG9ncy5Mb2dHcm91cCh0aGlzLCAnd2ViQ3Jhd2xlclNjaGVkdWxlckxvZ0dyb3VwJywgeyByZXRlbnRpb246IGxvZ3MuUmV0ZW50aW9uRGF5cy5PTkVfV0VFSyB9KSxcbiAgICAgIGVudmlyb25tZW50OiB7XG4gICAgICAgIFRBUkdFVFNfVEFCTEVfTkFNRTogdGFyZ2V0c1RhYmxlLnRhYmxlTmFtZSxcbiAgICAgICAgSk9CU19UQUJMRV9OQU1FOiBqb2JzVGFibGUudGFibGVOYW1lLFxuICAgICAgICBKT0JfUVVFVUVfQVJOOiBqb2JRdWV1ZS5qb2JRdWV1ZUFybixcbiAgICAgICAgSk9CX0RFRklOSVRJT05fQVJOOiB3ZWJDcmF3bGVySm9iRGVmaW5pdGlvbi5qb2JEZWZpbml0aW9uQXJuLFxuICAgICAgfSxcbiAgICB9KTtcblxuICAgIE5hZ1N1cHByZXNzaW9ucy5hZGRSZXNvdXJjZVN1cHByZXNzaW9ucyhzY2hlZHVsZXJGdW5jdGlvbi5yb2xlISwgW1xuICAgICAge1xuICAgICAgICBpZDogJ0F3c1NvbHV0aW9ucy1JQU00JyxcbiAgICAgICAgcmVhc29uOiAnTGFtYmRhIHVzZXMgdGhlIEFXU0xhbWJkYUJhc2ljRXhlY3V0aW9uUm9sZSBBV1MgTWFuYWdlZCBQb2xpY3kuJyxcbiAgICAgIH0sXG4gICAgXSk7XG5cbiAgICBOYWdTdXBwcmVzc2lvbnMuYWRkUmVzb3VyY2VTdXBwcmVzc2lvbnMoXG4gICAgICBzY2hlZHVsZXJGdW5jdGlvbi5yb2xlISxcbiAgICAgIFtcbiAgICAgICAge1xuICAgICAgICAgIGlkOiAnQXdzU29sdXRpb25zLUlBTTUnLFxuICAgICAgICAgIHJlYXNvbjogJ0FXU0xhbWJkYUJhc2ljRXhlY3V0aW9uUm9sZSBpcyB1c2VkLicsXG4gICAgICAgIH0sXG4gICAgICBdLFxuICAgICAgdHJ1ZSxcbiAgICApO1xuXG4gICAgdGFyZ2V0c1RhYmxlLmdyYW50UmVhZFdyaXRlRGF0YShzY2hlZHVsZXJGdW5jdGlvbik7XG4gICAgam9ic1RhYmxlLmdyYW50UmVhZFdyaXRlRGF0YShzY2hlZHVsZXJGdW5jdGlvbik7XG4gICAgc2NoZWR1bGVyRnVuY3Rpb24uYWRkVG9Sb2xlUG9saWN5KFxuICAgICAgbmV3IGlhbS5Qb2xpY3lTdGF0ZW1lbnQoe1xuICAgICAgICBhY3Rpb25zOiBbJ2JhdGNoOlN1Ym1pdEpvYiddLFxuICAgICAgICByZXNvdXJjZXM6IFt3ZWJDcmF3bGVySm9iRGVmaW5pdGlvbi5qb2JEZWZpbml0aW9uQXJuLCBqb2JRdWV1ZS5qb2JRdWV1ZUFybl0sXG4gICAgICB9KSxcbiAgICApO1xuXG4gICAgY29uc3QgcnVsZSA9IG5ldyBldmVudHMuUnVsZSh0aGlzLCAnd2ViQ3Jhd2xlclNjaGVkdWxlclJ1bGUnLCB7XG4gICAgICBzY2hlZHVsZTogZXZlbnRzLlNjaGVkdWxlLmV4cHJlc3Npb24oJ2Nyb24oMC8xNSAqICogKiA/ICopJyksXG4gICAgfSk7XG5cbiAgICBydWxlLmFkZFRhcmdldChuZXcgdGFyZ2V0cy5MYW1iZGFGdW5jdGlvbihzY2hlZHVsZXJGdW5jdGlvbikpO1xuXG4gICAgaWYgKHByb3BzLmVuYWJsZUxhbWJkYUNyYXdsZXIpIHtcbiAgICAgIGNvbnN0IGxhbWJkYUNyYXdsZXIgPSBuZXcgbGFtYmRhLkZ1bmN0aW9uKHRoaXMsICdsYW1iZGFDcmF3bGVyJywge1xuICAgICAgICBhcmNoaXRlY3R1cmU6IGxhbWJkYS5BcmNoaXRlY3R1cmUuWDg2XzY0LFxuICAgICAgICBmdW5jdGlvbk5hbWU6ICdsYW1iZGFfY3Jhd2xlcl9mdW5jdGlvbicgKyB0aGlzLnN0YWdlLFxuICAgICAgICB0cmFjaW5nOiB0aGlzLmxhbWJkYVRyYWNpbmcsXG4gICAgICAgIHRpbWVvdXQ6IGNkay5EdXJhdGlvbi5taW51dGVzKDE1KSxcbiAgICAgICAgbWVtb3J5U2l6ZTogMjA0OCxcbiAgICAgICAgaGFuZGxlcjogJ2luZGV4LmhhbmRsZXInLFxuICAgICAgICBydW50aW1lOiBsYW1iZGEuUnVudGltZS5OT0RFSlNfMjBfWCxcbiAgICAgICAgY29kZTogbGFtYmRhLkNvZGUuZnJvbURvY2tlckJ1aWxkKHBhdGguam9pbihfX2Rpcm5hbWUsICcuLi8uLi8uLi8uLi9sYW1iZGEvYXdzLXdlYi1jcmF3bGVyLWxhbWJkYScpKSxcbiAgICAgIH0pO1xuXG4gICAgICB0aGlzLmxhbWJkYUNyYXdsZXIgPSBsYW1iZGFDcmF3bGVyO1xuXG4gICAgICBOYWdTdXBwcmVzc2lvbnMuYWRkUmVzb3VyY2VTdXBwcmVzc2lvbnMoXG4gICAgICAgIGxhbWJkYUNyYXdsZXIucm9sZSEsXG4gICAgICAgIFtcbiAgICAgICAgICB7XG4gICAgICAgICAgICBpZDogJ0F3c1NvbHV0aW9ucy1JQU01JyxcbiAgICAgICAgICAgIHJlYXNvbjogJ0FXU0xhbWJkYUJhc2ljRXhlY3V0aW9uUm9sZSBpcyB1c2VkLicsXG4gICAgICAgICAgfSxcbiAgICAgICAgXSxcbiAgICAgICAgdHJ1ZSxcbiAgICAgICk7XG5cbiAgICAgIE5hZ1N1cHByZXNzaW9ucy5hZGRSZXNvdXJjZVN1cHByZXNzaW9ucyhsYW1iZGFDcmF3bGVyLnJvbGUhLCBbXG4gICAgICAgIHtcbiAgICAgICAgICBpZDogJ0F3c1NvbHV0aW9ucy1JQU00JyxcbiAgICAgICAgICByZWFzb246ICdMYW1iZGEgdXNlcyB0aGUgQVdTTGFtYmRhQmFzaWNFeGVjdXRpb25Sb2xlIEFXUyBNYW5hZ2VkIFBvbGljeS4nLFxuICAgICAgICB9LFxuICAgICAgXSk7XG4gICAgfVxuXG4gICAgdGhpcy5kYXRhQnVja2V0ID0gZGF0YUJ1Y2tldDtcbiAgICB0aGlzLnNuc1RvcGljID0gc25zVG9waWM7XG4gICAgdGhpcy50YXJnZXRzVGFibGUgPSB0YXJnZXRzVGFibGU7XG4gICAgdGhpcy5qb2JzVGFibGUgPSBqb2JzVGFibGU7XG4gICAgdGhpcy5qb2JRdWV1ZSA9IGpvYlF1ZXVlO1xuICAgIHRoaXMud2ViQ3Jhd2xlckpvYkRlZmluaXRpb24gPSB3ZWJDcmF3bGVySm9iRGVmaW5pdGlvbjtcbiAgICB0aGlzLmxhbWJkYUNyYXdsZXJBcGlTY2hlbWFQYXRoID0gcGF0aC5qb2luKF9fZGlybmFtZSwgJy4uLy4uLy4uLy4uL2xhbWJkYS9hd3Mtd2ViLWNyYXdsZXItbGFtYmRhL2FjdGlvbi1ncm91cC55YW1sJyk7XG4gIH1cbn1cbiJdfQ==